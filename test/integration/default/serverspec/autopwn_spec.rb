# -*- coding: utf-8 -*-

require 'spec_helper'

describe file '/opt/autopwn/targets' do
  it { should be_directory }
end

describe file '/opt/autopwn/targets/example' do
  it { should be_file }
  its(:content) { should match(/  - target_name: example/) }
  its(:content) { should match(/    target: 127.0.0.1/) }
  its(:content) { should match(%r{    url: /test}) }
  its(:content) { should match(/    port_number: 80/) }
  its(:content) { should match(/    protocol: https/) }
  its(:content) { should match(%r{    user_file: /tmp/users}) }
  its(:content) { should match(%r{    password_file: /tmp/passwords}) }
  its(:content) do
    should match(%r{    modules: \["tool/nmap", "assessment/webapp"\]})
  end
end
