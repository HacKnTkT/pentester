# -*- coding: utf-8 -*-

require_relative 'spec_helper'

describe 'pentester::goofile' do
  subject { ChefSpec::SoloRunner.new.converge(described_recipe) }

  it 'includes recipe[git]' do
    expect(subject).to include_recipe('git')
  end

  it 'sync git[/opt/goofile]' do
    expect(subject).to sync_git('/opt/goofile').with(
      repository: 'https://github.com/saydulk/goofile',
      reference: 'master')
  end

  it 'creates file[/opt/goofile/goofile.py]' do
    expect(subject).to create_file('/opt/goofile/goofile.py')
      .with(mode: '0755')
  end

  it 'creates link[/usr/local/bin/goofile]' do
    expect(subject).to create_link('/usr/local/bin/goofile')
      .with(link_type: :symbolic,
            to: '/opt/goofile/goofile.py')
  end
end
